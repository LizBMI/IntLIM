---
title: "creatInlLim function"
author: "mingrui liu"
date: "6/9/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir ="/Users/liumingrui/Documents/BIM/Files_for_understanding_Data_and_Package/BIM/breast")
```

## Introduction

The app we are working on was created using the breast cancer data sets.  We wish to use the breast cancer data-sets for gene expression and metabolite abundances to create a new MultiAssayDataSet object that we can analyze using our novel linear model.  

The first step is to load the MultiAssayExperiments file and set the path 

```{r}
rm(list = ls())
library(MultiAssayExperiment)
```

For this function, user need to input a file which contains all the filenames that we need to input in the multiAssayExperiment object.
To successfully built the multiAssayExperiment object, metabData, geneData and pData are required and metabMetadata and geneMetadata are optional.
```{r}
path<-"/Users/liumingrui/Desktop/breast.sample.csv"

stopifnot(is.character(path))
if (!file.exists(path)) {
        stop("CSV input file does not exist")
    }
csvfile <- as.data.frame(t(read.table(path, header=TRUE,
                                          sep=",", row.names="type")))

csvfile
```

Input all the files we need.
metabData and geneData should use the same level of identifier as their column name.
pData should contains the identifier as column
```{r}
    if(toString(csvfile$geneData)==''){
        stop("GeneData is required")
    }
    MData<-as.data.frame(read.csv(file=toString(csvfile$metabData),row.names = 1))
    if(toString(csvfile$metabData)==''){
        stop("MetabData is required")
    }
    GData<-as.data.frame(read.csv(file=toString(csvfile$geneData),row.names = 1))
    if(toString(csvfile$pData)==''){
        stop("pData is required")
    }
    pData<-as.data.frame(read.csv(file=toString(csvfile$pData)))

    Mmetadata<-NULL
    Gmetadata<-NULL
    if(!(toString(csvfile$metabMetadata)=='')){
        Mmetadata<-as.data.frame(read.csv(file=toString(csvfile$metabMetadata)))
    }
    if(!toString(csvfile$geneMetadata) ==''){
        Gmetadata<-as.data.frame(read.csv(file=toString(csvfile$geneMetadata)))
    }
``` 


```{r}    
    MData[1:5,1:5]
    GData[1:5,1:5]
    head(pData)
    
```

 ## ExperimentList

```{r}

    MData<-t(MData)
    GData <- t(GData)
    objlist <- list("Gene" = GData, "Metab" = MData)
    
```

## sampleMap
```{r}
    Mmap <- data.frame(primary = colnames(MData), assay =colnames(MData))
    Gmap <- data.frame(primary = colnames(GData), assay = colnames(GData))
    listmap <- list(Gmap, Mmap)
    names(listmap) <- c("Gene", "Metab")
    dfmap <- listToMap(listmap)
    head(dfmap)
```

 ##ColData
```{r}
    colData<-pData
    rownames(colData)<-colData$LHC
    
    head(colData)
```

##MetaData
```{r}
    listMetaData<-list(Gmetadata,Mmetadata)
    names(listMetaData)<-c("Gene", "Metab")
```

This can be combined in a MultiAssayExperiment object.  

```{r}
MultiAssay1 <- MultiAssayExperiment(objlist, colData, dfmap,listMetaData)
MultiAssay1
```

